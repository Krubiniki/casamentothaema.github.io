<!doctype html>
<html lang="pt-BR">
    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        
        <title>Casamento | Thaís e Mathews</title>

        <link rel="preconnect" href="https://fonts.gstatic.com">
        <link href="https://fonts.googleapis.com/css2?family=Reem+Kufi&family=Satisfy&display=swap" rel="stylesheet">
        <link rel="icon" type="image/png" href="assets/imgs/favicon.png"/>
        <link rel="stylesheet" type="text/css" href="assets/styles/reset.css?ver=1.0">
        <link rel="stylesheet" type="text/css" href="assets/styles/styleguide.css?ver=1.0">
        <link rel="stylesheet" type="text/css" href="assets/styles/header.css?ver=1.0">
        <link rel="stylesheet" type="text/css" href="assets/styles/footer.css?ver=1.0">
        <link rel="stylesheet" type="text/css" href="assets/styles/content.css?ver=1.0">

        <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-app.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-firestore.js"></script>
    </head>
    <body> 
        <header class="header">
            <nav>
                <a href="#home" class="header_link text main-grey">
                    <img src="assets/imgs/home.svg" class="header_icon"/>
                    <p>Home</p>
                    
                </a>
                <a href="#buffet" class="header_link text main-grey">
                    <img src="assets/imgs/tree.svg" class="header_icon"/>
                    <p>Buffet</p>
                </a>
                <a href="#lists" class="header_link text main-grey">
                    <img src="assets/imgs/gift.svg" class="header_icon"/>
                    <p>Listas</p>
                </a>
                <a href="#message" class="header_link text main-grey">
                    <img src="assets/imgs/msg.svg" class="header_icon"/>
                    <p>Mensagens</p>
                </a>
            </nav>
        </header>
        <main>
            <section id="home" class="section">
                <div class="home-container">
                    <div class="home-text-container">
                        <img src="assets/imgs/name-title.jpg" alt="Mathews e Thaís" class="img-mobile title-names"/>
                        <img src="assets/imgs/banner-home.jpg" alt="Banner Home" class="show-on-mobile img-mobile"/>
                        <p class="text main-black">
                            Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
                            <br><br>
                            Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
                        </p>
                    </div>
                    <div class="home-banner-container">
                        <img src="assets/imgs/banner-home.jpg" alt="Banner Home" class="hide-on-mobile"/>
                    </div>
                </div>
            </section>
            
            <div class="butterfly-container">
                <img src="assets/imgs/butterfly.png" alt="Butterfly"/>
            </div>
            
            <section id="buffet">
                <div class="buffet-container">
                    <div class="buffet-banner-container">
                        <img src="assets/imgs/banner-buffet.png" alt="Banner Buffet" class="hide-on-mobile"/>
                    </div>
                    <div class="buffet-text-container">
                        <h2 class="subtitle main-yellow">Dia da Festa!</h2>
                        <img src="assets/imgs/banner-buffet-mobile.jpg" alt="Banner Buffet Mobile" class="show-on-mobile img-mobile buffet-image"/>
                        <p class="text main-black">
                            O Buffet que escolhemos é o Canto Verde Eventos, não queremos dar muitos spoilers mas ele é como uma chácara, então já avisamos que a temperatura é mais amena no espaço. O Buffet conta com um salão principal e diversos outros espaços em que desejamos que explorem durante o evento, esperamos que seja divertido!
                            <br><br>
                            O espaço tem vaga para aproximadamente 20 carros, mas contratamos seguranças para olharem os carros caso parem na rua, o mais aconselhado é ir de Uber e curtir pra valer ;) Aqui embaixo deixamos a localização do buffet.
                        </p>
                    </div>
                </div>
            </section>
            
            <div class="buffet-maps-container">
                <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3656.4798730949256!2d-46.506804685149945!3d-23.587116984670043!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x94ce679af096ffab%3A0xca14a4ce7d2fa345!2sCanto%20Verde%20Eventos!5e0!3m2!1spt-BR!2sbr!4v1613411718705!5m2!1spt-BR!2sbr" frameborder="0" style="border:0;" allowfullscreen="" aria-hidden="false" tabindex="0" class="buffet-map"></iframe>
            </div>
            
            <section id="lists" class="section">
                <div class="lists-text-container">
                    <h1 class="subtitle main-yellow">Lista de Presentes</h1>
                    <p class="text main-black">Quer dar um presente de casamento para gente, mas não sabe o que dar ou não quer nem sair de casa para comprar, veja o catálogo abaixo:</p>
                </div>
                <div class="lists-cards-container">
                    <a class="item-card" href="https://listadecasamento.fastshop.com.br/lista/casamentothaema" target="_blank" rel="nofollow">
                        <img src="assets/imgs/fast-logo.png" alt="Cabrita" class="card-image fast-logo" />
                        <p class="list-card-text main-grey">Lista da</p>
                        <p class="list-card-text black">Fast</p>
                    </a>
                    <a class="item-card" href="https://lista.camicado.com.br/thaema" target="_blank" rel="nofollow">
                        <img src="assets/imgs/camicado-logo.png" alt="Camomila" class="card-image camicado-logo" />
                        <p class="list-card-text main-grey">Lista da</p>
                        <p class="list-card-text black">Camicado</p>
                    </a>
                    <a class="item-card" href="https://www.precolandia.com.br/lista-casamento/li-140848" target="_blank" rel="nofollow">
                        <img src="assets/imgs/precolandia-logo.jpg" alt="Camomila" class="card-image"/>
                        <p class="list-card-text main-grey">Lista da</p>
                        <p class="list-card-text black">Preçolandia</p>
                    </a>
                </div>
            </section>
            
            <div class="sunflower-section">
                <img src="assets/imgs/girassol.png" alt="flowers" class="sunflower-left"/>
                <img src="assets/imgs/girassol.png" alt="flowers" class="sunflower-right"/>
            </div>
            
            <section id="message" class="section">
                <h2 class="subtitle main-yellow">Nosso mural</h2>
                <div id="msgCards" class="message-cards-container">
                </div>
                <div class="message-text-container">
                    <div class="message">
                        <p class="text">Quer deixar uma recado no nosso mural?<br>Vamos ficar muito felizes em ler sua mensagem!</p>
                    </div>
                    <div class="message-input-container">
                        <input id="nameInput" type="text" name="nome" class="message-input text msg-text-color" placeholder="Nome">
                        <textarea id="textInput" name="texto" cols="30" rows="8" class="message-textarea text msg-text-color" placeholder="Escreva sua mensagem... (até 400 caracteres)" maxlength="400"></textarea>
                        <button id="sendButton" class="button-primary text">ENVIAR</button>
                    </div>
                </div>
                <div class="message-cards-container-mobile">
                    <!-- <div id="msgCard" class="message-card">
                        <p id="msgCardName" class="text main-yellow"></p>
                        <p id="msgCardText" class="msg-card-text msg-text-color"></p>
                    </div> -->
                </div>
            </section>
        </main>
        <footer class="footer">
            <div class="sunflower-container">
                <img src="assets/imgs/sunflower.png" alt="grass" class="sunflower"/>
            </div>
            <div class="footer-text-container">
                <div class="footer-made-by">
                    <p class="text main-black">Feito com carinho por Mathews Krubiniki e Thaís Castro</p>
                </div>
                <p class="text main-black">Agradecimentos especiais para:</p>
                <div class="footer-special-thanks">
                    <a href="https://www.linkedin.com/in/renato-haidamous-rampazzo-7aa648101/" target="_blank" rel="nofollow" class="text link main-black">Renato Haidamous (Desenvolvedor)</a>
                    <p class="text main-black">e</p>
                    <a href="https://www.linkedin.com/in/gustavo-bastos-012b49140/" target="_blank" rel="nofollow" class="text link main-black">Gustavo Bastos (Designer)</a>
                </div>
            </div>
        </footer>
    </body>
    </html>
    
    <script>
        // Initialize Cloud Firestore through Firebase
        firebase.initializeApp({
            apiKey: 'AIzaSyAkoEg6mVZwhUpKKsETgufaKAupFUZqANs',
            authDomain: 'wedding-5ac36.firebaseapp.com',
            projectId: 'wedding-5ac36'
        });
        
        const cardContainer = document.getElementById("msgCards")
        const msgCard = document.querySelector("#msgCard");
        const msgCardName = document.querySelector("#msgCardName");
        const msgCardText = document.querySelector("#msgCardText");
        const nameInput = document.querySelector("#nameInput");
        const textInput = document.querySelector("#textInput");
        const sendButton = document.querySelector("#sendButton");
        
        var message_db = firebase.firestore();
        var messagesData = message_db.collection("messages").get().then((querySnapshot) => {
        querySnapshot.forEach((message) => {
            messageCard = document.createElement('div')
            messageCard.className = "message-card"

            messageCardName = document.createElement('p')
            messageCardName.className = "text main-yellow"
            messageCardName.innerHTML = message.data().name

            messageCardText = document.createElement('p')
            messageCardText.className = "msg-card-text msg-text-color"
            messageCardText.innerHTML = message.data().text

            messageCard.appendChild(messageCardName);
            messageCard.appendChild(messageCardText);

            cardContainer.appendChild(messageCard)
        });
        // adicionar o catch error para caso tenha problema em puxar do firestore + mostrar feedback no msgCards
        //     .catch((error) => {
        //     console.log("Error getting documents: ", error);
        // });
    })    
    
    function loading(isLoading,htmlButtonElement,condition){
        if(isLoading == true){
            htmlButtonElement.disable = true;
            htmlButtonElement.style.backgroundColor = '#D3D3D3';
        } else {
            setTimeout(() => {  
                htmlButtonElement.disable = false;
                htmlButtonElement.style.backgroundColor = '#F4A83F';
                if(condition == 'empty') alert("Você deve preencher seu nome e a mensagem antes de enviar!");
                if(condition == 'error') alert("Ocorreu um erro, favor tentar novamente!");
                if(condition == 'success') {
                    nameInput.value = '';
                    textInput.value = '';
                    alert("Mensagem enviada com sucesso!");
                }
            }, 3000);
        }
    };

    sendButton.addEventListener("click", function(){
        loading(true,sendButton)
        const msgText = textInput.value;
        const msgName = nameInput.value;
        if(msgText != "" && msgName != ""){
            let randomNumber = Math.floor(100000 + Math.random() * 900000);
            const msgRef = message_db.doc(`/messages/message-${msgName}-${randomNumber}`);
            console.log("Tentando salvar nova mensagem no firestore...")
            msgRef.set({
                name:msgName,
                text:msgText,
            }).then(function(){
                loading(false,sendButton,'success')
                console.log("Mensagem salva")
                // adicionar o novo elemento html na lista de cards
            }).catch(function(error){
                loading(false,sendButton,'error')
                console.log("Ocorreu algum erro: ",error)
            });
        } else {
            loading(false,sendButton,'empty')
        }
    })

</script>